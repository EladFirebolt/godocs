---
layout: default
title: Custom Identity Provider
description: Learn how to configure a custom Identity Provider integration with Firebolt. 
great_grand_parent: Guides
grand_parent: Configure security
parent: Configure SSO
---

# Custom Identity Provider

To use a SAML 2.0 compliant service or application as your IDP for single sign on (SSO) with Firebolt, complete the following steps:
1. In the service/application interface, define a custom SHA-256 application for Firebolt. Follow the specific instructions of the service/application in order to define such a custom application.
2. In the interface, create a user for each end-user that needs to access Firebolt. When creating the users, make sure to specify the email address for each of those users. Firebolt uses those email addresses to create the corresponding logins in Firebolt. See [setting up SSO](sso.md) for more information.
3. Obtain values for Audience URI and ACS (Consumer) URL to use in the IDP setup from Firebolt support team. 

    IMPORTANT: The SSO authentication will not work if these values are not setup properly in your IDP.
    
    If, for instance your organization name is `acmeorg` and provider name you specify is `custom`:
    - Example of ACS URL: `https://id.app.firebolt.io/login/callback?connection=acmeorg-custom&organization=<organization_identifier>`
    - Example of Audience URI: `urn:auth0:firebolt-app-v2:acmeorg-custom`

        {: .note} 
        The **Audience URI**, or Audience Restriction, determines the intended recipient or audience for the SAML Assertion. Depending on the vendor, this field might also be referred to as the **"Entity ID"**. 

4. Obtain the SSO URL (This is the URL endpoint to which Firebolt sends the SAML requests.) and certificate (used to verify the communication between the IDP and Firebolt) for your custom IDP. You will need the **SSO URL value** and **certificate** to set up SSO.

{: .note}
With this information in hand, you're now ready to integrate your Identity Provider with Firebolt. 

#### UI
1. To configure the Firebolt SSO integration via the UI, Navigate to **Configure > SSO** in Firebolt. 
2. Enter the following information:
- ```signOnUrl```: The sign-on URL, provided by the SAML identity provider, to which Firebolt sends the SAML requests. The URL is IdP-specific and is determined by the identity provider during configuration. For example, using Okta as an identity provider, the URL might look like: `https://okta_account_name.okta.com/app/okta_firebolt_app_id/sso/saml` 
- ```signoutUrl(optional)```: The sign-out URL, provided by the application owner, to be used when the user signs out of the application.```
- ```issuer```: A unique value generated by the SAML identity provider specifying the issuer value.
- ```provider```: The provider's name - for example: ```JumpCloud```. Use the **Custom** label if you are using a SAML 2.0-compliant service or application as your IdP. Once the provider has been selected, it can't be changed, but you can delete the SSO configuration ([see below](#delete-sso)) to then set up using a different provider. 
- ```label```: The label to use for the SSO login button. If not provided, the Provider field value is used. 
- ```certificate```: The certificate to verify the communication between the identity provider and Firebolt. The certificate needs to be in PEM or CER format, and can be uploaded from your computer by choosing **Import certificate** or entered in the text box.
- ```field mapping```: Mapping to your identity provider's first and last name in key-value pairs. If additional fields are required, choose **Add another key-value pair**. Mapping is required for Firebolt to fill in the login’s given and last names the first time the user logs in using SSO. If this field remains empty when a login that represents the user is being created (read more in the [log in using SSO](#log-in-using-sso) section), the login's first and last name fields will contain “NA”. Those fields can be updated later by running the [ALTER LOGIN](../../../sql_reference/commands/access-control/alter-login.md) command. 
      Here’s an example of how to set up field mapping:

      ```json  
        {
            "given_name": "name",
            "family_name": "surname"
        }
      ```

      where the "given_name" (first name) is mapped to the "name" field from the IDP, and the "family_name" (last name) is mapped from the "surname" field.
3. Choose **Update changes**.

#### SQL

To create your SSO connection in Firebolt, you can use the following SQL as an example:
```sql
ALTER ORGANIZATION vsko SET SSO = '{
  "signOnUrl": "https://dev-a8jnpkgk4y7gylt5.us.auth0.com/samlp/9aLOXgDHcqxW1gWtBuWNxVLbKNyv1LQV",
  "issuer": "auth0",
  "provider": "auth0",
  "label": "Auth0 Company IdP",
  "fieldMapping": {
    "given_name": "name",
    "family_name": "surname"
  },
  "certificate": "<certificate>",
}';
```

where
- ```signOnUrl```: The sign-on URL, provided by the SAML identity provider, to which Firebolt sends the SAML requests. The URL is IdP-specific and is determined by the identity provider during configuration. For Auth0, this value is the Identity Provider Login URL value copied earlier ([during Auth0 setup](#auth0))
- ```signoutUrl(optional)```: The sign-out URL, provided by the application owner, to be used when the user signs out of the application.```
- ```issuer```: A unique value generated by the SAML identity provider specifying the issuer value.
- ```provider```: The provider's name - for example: ```Auth0```. 
- ```label```: The label to use for the SSO login button. If not provided, the Provider field value is used. 
- ```certificate```: The certificate to verify the communication between the identity provider and Firebolt. The certificate needs to be in PEM or CER format, and can be uploaded from your computer by choosing **Import certificate** or entered in the text box.
- ```field mapping```: Mapping to your identity provider's first and last name in key-value pairs. If additional fields are required, choose **Add another key-value pair**. Mapping is required for Firebolt to fill in the login’s given and last names the first time the user logs in using SSO. 
      Here’s an example of how to set up field mapping:

      ```json  
        {
            "given_name": "name",
            "family_name": "surname"
        }
      ```

      where the "given_name" (first name) is mapped to the "name" field from the IDP, and the "family_name" (last name) is mapped from the "surname" field.


## Edit SSO settings

SSO settings can be edited in two ways - using SQL or the UI.  To edit SSO settings using SQL, use the [ALTER ORGANIZATION](../../../sql_reference/commands/data-definition/alter-organization.md) statement. For example:

```sql
ALTER ORGANIZATION SET SSO = ‘{
  “signOnUrl”: “https://abc.okta.com/app/okta_firebolt_app_id/sso/saml”,
  “signOutUrl”: “https://myapp.exampleco.com/saml/logout”, 
  “issuer”: “issuer”,
  “provider”: “Okta”, 
  “label”: “Okta”,
  “fieldMapping”: “mapping”,
  “certificate”: “XXXXXXXXXXXXXXXX”,
}’;
```

To edit SSO settings via the UI:
1. Click **Configure** to open the configure space, then choose **SSO**.

2. Edit the desired properties.

3. Choose **Update changes**.

## Delete SSO

To disable the ability to log in using SSO, SSO settings can be deleted in two ways - using SQL or the UI.  To edit SSO settings using SQL, use the following command:

```sql
ALTER ORGANIZATION SET SSO = DEFAULT;
```

To edit SSO settings via the UI:
1. Click **Configure** to open the configure space, then choose **SSO**.

2. Choose **Clear SSO configuration**.

3. Choose **Update changes**.


Once SSO configuration is deleted:
- Logins created via SSO will remain in your organization, but won't be able to log in to Firebolt unless enabled to log in using a password. Use the [ALTER LOGIN](../../../sql_reference/commands/access-control/alter-login.md) statement to configure this. 
- All logins with `is_sso_provisioned=true` will be updated to `sso_provisioned=false`.


## Log in using SSO

1. Go to <a href="https://go.firebolt.io/login">go.firebolt.io/login</a>.
2. Enter the name of your organization and choose **Continue to log in**.
If you can’t remember the name of the organization, next to “Don’t know your organization name?” and choose **Find out**.
3. Enter the email address you use to log in to Firebolt and choose **Send link**.
4. Check your inbox for an email with the link to log in directly to your organization. You can bookmark this link so that you can use it for future reference.
5. Choose **Log in with <IDP>**.
You will be redirected to the IDP to authenticate. Once authenticated, you will be redirected back to Firebolt.

Upon login, if a login with the specified email address does not exist, Firebolt will create a new login with the email address, first, and last name as specified in the SAML assertation received from the IDP. 
When the login is created, it will be able to authenticate via SSO only - the `IS_PASSWORD_ENABLED` property will be set to False.

If the login exists (and field mapping is not empty), but the first or last name is different than the one specified in the IDP, Firebolt will update the properties with the new values. Otherwise,  those fields remain the same and the login will authenticate normally.
